<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>Le meilleur des cocktails</title>

    <script type="text/javascript">

      var img = document.createElement("img");

      function goCocktail(){
        var requette = "";
        var requetteTraduction = "";
        var alcool = "";
        var ingredients = "";
        var block = document.getElementById("image");

        if (document.getElementById('choix1').checked) {
          alcool="Vodka";
        }
        else if(document.getElementById('choix2').checked){
          alcool="Rum";
        }
        else if(document.getElementById('choix3').checked){
          alcool="Beer";
        }
        else if(document.getElementById('choix4').checked){
          alcool="Gin";
        }

        requette="http://iparla.iutbayonne.univ-pau.fr/~acachenaut/WebService/projetCocktail/cocktailRandom.php?alcool="+alcool;
        console.log(requette);
        fetch(requette)
          .then(response => {
              return response.json()

          })
          .then(data => {
            console.log(data);
            document.getElementById("nomCocktail").innerHTML = "Voici un cocktail : " + data['strDrink'];
            img.src = data['strDrinkThumb'];
            img.width=150;
            img.heigth=150;
            block.appendChild(img);

            //Requette de traduction de la recette
            requetteTraduction="https://translate.yandex.net/api/v1.5/tr.json/translate?key=trnsl.1.1.20200325T134219Z.58726c5658221c9c.66519b955b3e3d2988042005cb584d29db19cd30&text="+data['strInstructions']+"&lang=en-fr&format=plain";
          fetch(requetteTraduction)
            .then(response => {
              return response.json()
            })
            .then(data => {
            	console.log(data);
              document.getElementById("recette").innerHTML = "Le nombre obtenu : " + data['text'];
            })

            for (var i = 1; i<15;i++){
              if (data['strIngredient'+i]==null){
                break;
              }
              else{
                if (data['strIngredient'+(i+1)]==null){
                ingredients+=data['strIngredient'+i];
                }
                else{
                  ingredients+=data['strIngredient'+i]+",";
                }
              }
            }

            requetteTraduction="https://translate.yandex.net/api/v1.5/tr.json/translate?key=trnsl.1.1.20200325T134219Z.58726c5658221c9c.66519b955b3e3d2988042005cb584d29db19cd30&text="+ingredients+"&lang=en-fr&format=plain";
          fetch(requetteTraduction)
            .then(response => {
              return response.json()
            })
            .then(data => {
            	console.log(data);
              document.getElementById("ingredients").innerHTML = "Voici les ingrédients nécessaires : " + data['text'];
            })


          })

      }

    </script>
  </head>
  <body>
    <h1>Confinement ? Ennui ?</h1>
    <h2>C'est le moment d'essayer l'un de nos cocktails</h2>
    Veuillez sélectionner un alcool :
    <input type=radio id=choix1 name=choix value=Vodka 1> Vodka
    <input type=radio id=choix2 name=choix value=Rhum 2> Rhum
    <input type=radio id=choix3 name=choix value=Beer 3 > Bière
    <input type=radio id=choix4 name=choix value=Gin 3 > Gin
    <button type="button" name="button" onclick="goCocktail()">Chercher !</button><br>
    <p id="nomCocktail"></p>
    <div id="image"></div>
    <p id="recette"></p>
    <p id="ingredients"></p>



    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>
